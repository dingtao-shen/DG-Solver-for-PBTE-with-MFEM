#pragma once

#include "Eigen/Dense"

namespace PolyFem {

    template<int dim, int degree>
    class Quadrature{
        private:
            int dimension;
            int deg;
            int num_points;
            Eigen::MatrixXd points;
            Eigen::VectorXd weights;
        public:
            Quadrature();
            ~Quadrature();
            int getDim() const {return dimension;}
            int getDegree() const {return deg;}
            int getNumPoints() const {return num_points;}
            const Eigen::VectorXd& getWeights() const {return weights;}
            Eigen::MatrixXd getPoints() const {
                Eigen::MatrixXd Vertices = Eigen::MatrixXd::Zero(dimension, dimension+1);
                for(int i = 1; i < dimension+1; i++){
                    Vertices(i-1,i) = 1.0;
                }
                Eigen::MatrixXd CP = Vertices * points;
                return CP;
            }
            Eigen::MatrixXd getPoints(const Eigen::MatrixXd& vertices) const {
                Eigen::MatrixXd CP = vertices * points;
                return CP;
            }
            double CalQuad(const Eigen::VectorXd& FVal) const {
                assert(FVal.size() == points.cols());
                double IntVal = 0.0;
                for(int i = 0; i < points.cols(); i++){
                    IntVal += weights(i) * FVal(i);
                }
                return IntVal;
            }
    };

    template<int dim, int degree>
    Quadrature<dim, degree>::Quadrature(){
        dimension = dim;
        deg = degree;
        Eigen::MatrixXd points_;
        
        if(dimension == 2){
            if(deg == 1){
                num_points = 1;
                points.resize(3, 1);
                points_.resize(1, 3);
                weights.resize(1);
                points_ << 0.333333333333, 0.333333333333, 0.333333333333;
                points = points_.transpose();
                weights << 1.000000000000 / 2.0;
            }
            else if(deg == 2){
                num_points = 3;
                points.resize(3, 3);
                points_.resize(3, 3);
                weights.resize(3);
                points_ << 0.500000000000, 0.500000000000, 0.000000000000,
                         0.500000000000, 0.000000000000, 0.500000000000,
                         0.000000000000, 0.500000000000, 0.500000000000;
                points = points_.transpose();
                weights << 0.333333333333 / 2.0, 0.333333333333 / 2.0, 0.333333333333 / 2.0;
            }
            else if(deg == 3){
                num_points = 6;
                points.resize(3, 6);
                points_.resize(6, 3);
                weights.resize(6);
                points_ << 0.659027622374, 0.231933368553, 0.109039009073,
                         0.109039009073, 0.659027622374, 0.231933368553,
                         0.231933368553, 0.109039009073, 0.659027622374,
                         0.231933368553, 0.659027622374, 0.109039009073,
                         0.109039009073, 0.231933368553, 0.659027622374,
                         0.659027622374, 0.109039009073, 0.231933368553;
                points = points_.transpose();
                weights << 0.166666666667 / 2.0, 0.166666666667 / 2.0, 0.166666666667 / 2.0,
                         0.166666666667 / 2.0, 0.166666666667 / 2.0, 0.166666666667 / 2.0;
            }
            else if(deg == 4){
                num_points = 6;
                points.resize(3, 6);
                points_.resize(6, 3);
                weights.resize(6);
                points_ << 0.091576213510, 0.091576213510, 0.816847572980,
                         0.445948490916, 0.445948490916, 0.108103018168,
                         0.091576213510, 0.816847572980, 0.091576213510,
                         0.445948490916, 0.108103018168, 0.445948490916,
                         0.816847572980, 0.091576213510, 0.091576213510,
                         0.108103018168, 0.445948490916, 0.445948490916;
                points = points_.transpose();
                weights << 0.109951743655 / 2.0, 0.223381589678 / 2.0, 0.109951743655 / 2.0,
                         0.223381589678 / 2.0, 0.109951743655 / 2.0, 0.223381589678 / 2.0;
            }
            else if(deg == 5){
                num_points = 7;
                points.resize(3, 7);
                points_.resize(7, 3);
                weights.resize(7);
                points_ << 0.333333333333, 0.333333333333, 0.333333333333,
                         0.101286507323, 0.101286507323, 0.797426985353,
                         0.470142064105, 0.470142064105, 0.059715871790,
                         0.101286507323, 0.797426985353, 0.101286507323,
                         0.470142064105, 0.059715871790, 0.470142064105,
                         0.797426985353, 0.101286507323, 0.101286507323,
                         0.059715871790, 0.470142064105, 0.470142064105;
                points = points_.transpose();
                weights << 0.225000000000 / 2.0, 0.125939180545 / 2.0, 0.132394152789 / 2.0,
                         0.125939180545 / 2.0, 0.132394152789 / 2.0, 0.125939180545 / 2.0,
                         0.132394152789 / 2.0;
            }
            else if(deg == 6){
                num_points = 12;
                points.resize(3, 12);
                points_.resize(12, 3);
                weights.resize(12);
                points_ << 0.063089014492, 0.063089014492, 0.873821971017,
                         0.249286745171, 0.249286745171, 0.501426509658,
                         0.063089014492, 0.873821971017, 0.063089014492,
                         0.249286745171, 0.501426509658, 0.249286745171,
                         0.873821971017, 0.063089014492, 0.063089014492,
                         0.501426509658, 0.249286745171, 0.249286745171,
                         0.636502499121, 0.310352451034, 0.053145049845,
                         0.053145049845, 0.636502499121, 0.310352451034,
                         0.310352451034, 0.053145049845, 0.636502499121,
                         0.310352451034, 0.636502499121, 0.053145049845,
                         0.053145049845, 0.310352451034, 0.636502499121,
                         0.636502499121, 0.053145049845, 0.310352451034;
                points = points_.transpose();
                weights << 0.050844906370 / 2.0, 0.116786275726 / 2.0, 0.050844906370 / 2.0,
                         0.116786275726 / 2.0, 0.050844906370 / 2.0, 0.116786275726 / 2.0,
                         0.082851075618 / 2.0, 0.082851075618 / 2.0, 0.082851075618 / 2.0,
                         0.082851075618 / 2.0, 0.082851075618 / 2.0, 0.082851075618 / 2.0;
            }
            else if(deg == 7){
                num_points = 15;
                points.resize(3, 15);
                points_.resize(15, 3);
                weights.resize(15);
                points_ << 0.064930513159, 0.064930513159, 0.870138973682,
                         0.284575584249, 0.517039939069, 0.198384476682,
                         0.313559184385, 0.043863471792, 0.642577343823,
                         0.064930513159, 0.870138973682, 0.064930513159,
                         0.198384476682, 0.284575584249, 0.517039939069,
                         0.642577343823, 0.313559184385, 0.043863471792,
                         0.870138973682, 0.064930513159, 0.064930513159,
                         0.517039939069, 0.198384476682, 0.284575584249,
                         0.043863471792, 0.642577343823, 0.313559184385,
                         0.517039939069, 0.284575584249, 0.198384476682,
                         0.043863471792, 0.313559184385, 0.642577343823,
                         0.198384476682, 0.517039939069, 0.284575584249,
                         0.642577343823, 0.043863471792, 0.313559184385,
                         0.284575584249, 0.198384476682, 0.517039939069,
                         0.313559184385, 0.642577343823, 0.043863471792;
                points = points_.transpose();
                weights << 0.053077801790 / 2.0, 0.070853083692 / 2.0, 0.069274682079 / 2.0,
                         0.053077801790 / 2.0, 0.070853083692 / 2.0, 0.069274682079 / 2.0,
                         0.053077801790 / 2.0, 0.070853083692 / 2.0, 0.069274682079 / 2.0,
                         0.070853083692 / 2.0, 0.069274682079 / 2.0, 0.070853083692 / 2.0,
                         0.069274682079 / 2.0, 0.070853083692 / 2.0, 0.069274682079 / 2.0;
            }
            else if(deg == 8){
                num_points = 16;
                points.resize(3, 16);
                points_.resize(16, 3);
                weights.resize(16);
                points_ << 0.333333333333, 0.333333333333, 0.333333333333,
                         0.459292588293, 0.459292588293, 0.081414823415,
                         0.050547228317, 0.050547228317, 0.898905543366,
                         0.170569307752, 0.170569307752, 0.658861384496,
                         0.459292588293, 0.081414823415, 0.459292588293,
                         0.050547228317, 0.898905543366, 0.050547228317,
                         0.170569307752, 0.658861384496, 0.170569307752,
                         0.081414823415, 0.459292588293, 0.459292588293,
                         0.898905543366, 0.050547228317, 0.050547228317,
                         0.658861384496, 0.170569307752, 0.170569307752,
                         0.008394777410, 0.728492392955, 0.263112829635,
                         0.263112829635, 0.008394777410, 0.728492392955,
                         0.728492392955, 0.263112829635, 0.008394777410,
                         0.728492392955, 0.008394777410, 0.263112829635,
                         0.263112829635, 0.728492392955, 0.008394777410,
                         0.008394777410, 0.263112829635, 0.728492392955;
                points = points_.transpose();
                weights << 0.144315607678 / 2.0, 0.095091634267 / 2.0, 0.032458497623 / 2.0,
                         0.103217370535 / 2.0, 0.095091634267 / 2.0, 0.032458497623 / 2.0,
                         0.103217370535 / 2.0, 0.095091634267 / 2.0, 0.032458497623 / 2.0,
                         0.103217370535 / 2.0, 0.027230314174 / 2.0, 0.027230314174 / 2.0,
                         0.027230314174 / 2.0, 0.027230314174 / 2.0, 0.027230314174 / 2.0,
                         0.027230314174 / 2.0;
            }
            else if(deg == 9){
                num_points = 19;
                points.resize(3, 19);
                points_.resize(19, 3);
                weights.resize(19);
                points_ << 0.333333333333, 0.333333333333, 0.333333333333,
                         0.489682519199, 0.489682519199, 0.020634961603,
                         0.437089591493, 0.437089591493, 0.125820817014,
                         0.188203535619, 0.188203535619, 0.623592928762,
                         0.044729513394, 0.044729513394, 0.910540973211,
                         0.489682519199, 0.020634961603, 0.489682519199,
                         0.437089591493, 0.125820817014, 0.437089591493,
                         0.188203535619, 0.623592928762, 0.188203535619,
                         0.044729513394, 0.910540973211, 0.044729513394,
                         0.020634961603, 0.489682519199, 0.489682519199,
                         0.125820817014, 0.437089591493, 0.437089591493,
                         0.623592928762, 0.188203535619, 0.188203535619,
                         0.910540973211, 0.044729513394, 0.044729513394,
                         0.036838412055, 0.741198598784, 0.221962989161,
                         0.221962989161, 0.036838412055, 0.741198598784,
                         0.741198598784, 0.221962989161, 0.036838412055,
                         0.741198598784, 0.036838412055, 0.221962989161,
                         0.221962989161, 0.741198598784, 0.036838412055,
                         0.036838412055, 0.221962989161, 0.741198598784;
                points = points_.transpose();
                weights << 0.097135796283 / 2.0, 0.031334700227 / 2.0, 0.077827541005 / 2.0,
                         0.079647738927 / 2.0, 0.025577675659 / 2.0, 0.031334700227 / 2.0,
                         0.077827541005 / 2.0, 0.079647738927 / 2.0, 0.025577675659 / 2.0,
                         0.031334700227 / 2.0, 0.077827541005 / 2.0, 0.079647738927 / 2.0,
                         0.025577675659 / 2.0, 0.043283539377 / 2.0, 0.043283539377 / 2.0,
                         0.043283539377 / 2.0, 0.043283539377 / 2.0, 0.043283539377 / 2.0,
                         0.043283539377 / 2.0;
            }
            else if(deg == 10){
                num_points = 25;
                points.resize(3, 25);
                points_.resize(25, 3);
                weights.resize(25);
                points_ << 0.333333333333, 0.333333333333, 0.333333333333,
                         0.032055373217, 0.032055373217, 0.935889253566,
                         0.142161101057, 0.142161101057, 0.715677797887,
                         0.032055373217, 0.935889253566, 0.032055373217,
                         0.142161101057, 0.715677797887, 0.142161101057,
                         0.935889253566, 0.032055373217, 0.032055373217,
                         0.715677797887, 0.142161101057, 0.142161101057,
                         0.028367665340, 0.163701733737, 0.807930600923,
                         0.029619889489, 0.369146781828, 0.601233328683,
                         0.148132885784, 0.321812995289, 0.530054118927,
                         0.807930600923, 0.028367665340, 0.163701733737,
                         0.601233328683, 0.029619889489, 0.369146781828,
                         0.530054118927, 0.148132885784, 0.321812995289,
                         0.163701733737, 0.807930600923, 0.028367665340,
                         0.369146781828, 0.601233328683, 0.029619889489,
                         0.321812995289, 0.530054118927, 0.148132885784,
                         0.163701733737, 0.028367665340, 0.807930600923,
                         0.369146781828, 0.029619889489, 0.601233328683,
                         0.321812995289, 0.148132885784, 0.530054118927,
                         0.807930600923, 0.163701733737, 0.028367665340,
                         0.601233328683, 0.369146781828, 0.029619889489,
                         0.530054118927, 0.321812995289, 0.148132885784,
                         0.028367665340, 0.807930600923, 0.163701733737,
                         0.029619889489, 0.601233328683, 0.369146781828,
                         0.148132885784, 0.530054118927, 0.321812995289;
                points = points_.transpose();
                weights << 0.081743329146 / 2.0, 0.013352968813 / 2.0, 0.045957963605 / 2.0,
                         0.013352968813 / 2.0, 0.045957963605 / 2.0, 0.013352968813 / 2.0,
                         0.045957963605 / 2.0, 0.025297757707 / 2.0, 0.034184648163 / 2.0,
                         0.063904906396 / 2.0, 0.025297757707 / 2.0, 0.034184648163 / 2.0,
                         0.063904906396 / 2.0, 0.025297757707 / 2.0, 0.034184648163 / 2.0,
                         0.063904906396 / 2.0, 0.025297757707 / 2.0, 0.034184648163 / 2.0,
                         0.063904906396 / 2.0, 0.025297757707 / 2.0, 0.034184648163 / 2.0,
                         0.063904906396 / 2.0, 0.025297757707 / 2.0, 0.034184648163 / 2.0,
                         0.063904906396 / 2.0;
            }
            else if(deg == 11){
                num_points = 28;
                points.resize(3, 28);
                points_.resize(28, 3);
                weights.resize(28);
                points_ << 0.333333333333, 0.333333333333, 0.333333333333,
                         0.030846895636, 0.030846895636, 0.938306208729,
                         0.498780165178, 0.498780165178, 0.002439669643,
                         0.113207827287, 0.113207827287, 0.773584345427,
                         0.436655016393, 0.436655016393, 0.126689967214,
                         0.214483458619, 0.214483458619, 0.571033082761,
                         0.030846895636, 0.938306208729, 0.030846895636,
                         0.498780165178, 0.002439669643, 0.498780165178,
                         0.113207827287, 0.773584345427, 0.113207827287,
                         0.436655016393, 0.126689967214, 0.436655016393,
                         0.214483458619, 0.571033082761, 0.214483458619,
                         0.938306208729, 0.030846895636, 0.030846895636,
                         0.002439669643, 0.498780165178, 0.498780165178,
                         0.773584345427, 0.113207827287, 0.113207827287,
                         0.126689967214, 0.436655016393, 0.436655016393,
                         0.571033082761, 0.214483458619, 0.214483458619,
                         0.014366662570, 0.159303619838, 0.826329717593,
                         0.047664066972, 0.310631216313, 0.641704716714,
                         0.826329717593, 0.014366662570, 0.159303619838,
                         0.641704716714, 0.047664066972, 0.310631216313,
                         0.159303619838, 0.826329717593, 0.014366662570,
                         0.310631216313, 0.641704716714, 0.047664066972,
                         0.159303619838, 0.014366662570, 0.826329717593,
                         0.310631216313, 0.047664066972, 0.641704716714,
                         0.826329717593, 0.159303619838, 0.014366662570,
                         0.641704716714, 0.310631216313, 0.047664066972,
                         0.014366662570, 0.826329717593, 0.159303619838,
                         0.047664066972, 0.641704716714, 0.310631216313;
                points = points_.transpose();
                weights << 0.081445134709 / 2.0, 0.012249296951 / 2.0, 0.012465491874 / 2.0,
                         0.040129242381 / 2.0, 0.063094872160 / 2.0, 0.067845107744 / 2.0,
                         0.012249296951 / 2.0, 0.012465491874 / 2.0, 0.040129242381 / 2.0,
                         0.063094872160 / 2.0, 0.067845107744 / 2.0, 0.012249296951 / 2.0,
                         0.012465491874 / 2.0, 0.040129242381 / 2.0, 0.063094872160 / 2.0,
                         0.067845107744 / 2.0, 0.014557623338 / 2.0, 0.040642848656 / 2.0,
                         0.014557623338 / 2.0, 0.040642848656 / 2.0, 0.014557623338 / 2.0,
                         0.040642848656 / 2.0, 0.014557623338 / 2.0, 0.040642848656 / 2.0,
                         0.014557623338 / 2.0, 0.040642848656 / 2.0, 0.014557623338 / 2.0,
                         0.040642848656 / 2.0;
            }
            else if(deg == 12){
                num_points = 33;
                points.resize(3, 33);
                points_.resize(33, 3);
                weights.resize(33);
                points_ << 0.271462507015, 0.271462507015, 0.457074985970,
                         0.109257827659, 0.109257827659, 0.781484344681,
                         0.440111648659, 0.440111648659, 0.119776702683,
                         0.488203750946, 0.488203750946, 0.023592498109,
                         0.024646363436, 0.024646363436, 0.950707273127,
                         0.271462507015, 0.457074985970, 0.271462507015,
                         0.109257827659, 0.781484344681, 0.109257827659,
                         0.440111648659, 0.119776702683, 0.440111648659,
                         0.488203750946, 0.023592498109, 0.488203750946,
                         0.024646363436, 0.950707273127, 0.024646363436,
                         0.457074985970, 0.271462507015, 0.271462507015,
                         0.781484344681, 0.109257827659, 0.109257827659,
                         0.119776702683, 0.440111648659, 0.440111648659,
                         0.023592498109, 0.488203750946, 0.488203750946,
                         0.950707273127, 0.024646363436, 0.024646363436,
                         0.116296019678, 0.255454228639, 0.628249751684,
                         0.021382490256, 0.127279717234, 0.851337792510,
                         0.023034156355, 0.291655679738, 0.685310163906,
                         0.628249751684, 0.116296019678, 0.255454228639,
                         0.851337792510, 0.021382490256, 0.127279717234,
                         0.685310163906, 0.023034156355, 0.291655679738,
                         0.255454228639, 0.628249751684, 0.116296019678,
                         0.127279717234, 0.851337792510, 0.021382490256,
                         0.291655679738, 0.685310163906, 0.023034156355,
                         0.255454228639, 0.116296019678, 0.628249751684,
                         0.127279717234, 0.021382490256, 0.851337792510,
                         0.291655679738, 0.023034156355, 0.685310163906,
                         0.628249751684, 0.255454228639, 0.116296019678,
                         0.851337792510, 0.127279717234, 0.021382490256,
                         0.685310163906, 0.291655679738, 0.023034156355,
                         0.116296019678, 0.628249751684, 0.255454228639,
                         0.021382490256, 0.851337792510, 0.127279717234,
                         0.023034156355, 0.685310163906, 0.291655679738;
                points = points_.transpose();
                weights << 0.062541213196 / 2.0, 0.028486052069 / 2.0, 0.049918334928 / 2.0,
                         0.024266838081 / 2.0, 0.007931642510 / 2.0, 0.062541213196 / 2.0,
                         0.028486052069 / 2.0, 0.049918334928 / 2.0, 0.024266838081 / 2.0,
                         0.007931642510 / 2.0, 0.062541213196 / 2.0, 0.028486052069 / 2.0,
                         0.049918334928 / 2.0, 0.024266838081 / 2.0, 0.007931642510 / 2.0,
                         0.043227363659 / 2.0, 0.015083677577 / 2.0, 0.021783585039 / 2.0,
                         0.043227363659 / 2.0, 0.015083677577 / 2.0, 0.021783585039 / 2.0,
                         0.043227363659 / 2.0, 0.015083677577 / 2.0, 0.021783585039 / 2.0,
                         0.043227363659 / 2.0, 0.015083677577 / 2.0, 0.021783585039 / 2.0,
                         0.043227363659 / 2.0, 0.015083677577 / 2.0, 0.021783585039 / 2.0,
                         0.043227363659 / 2.0, 0.015083677577 / 2.0, 0.021783585039 / 2.0;
            }
            else if(deg == 13){
                num_points = 37;
                points.resize(3, 37);
                points_.resize(37, 3);
                weights.resize(37);
                points_ << 0.333333333333, 0.333333333333, 0.333333333333,
                         0.496135894741, 0.496135894741, 0.007728210518,
                         0.469608689653, 0.469608689653, 0.060782620693,
                         0.231110284949, 0.231110284949, 0.537779430102,
                         0.414477570279, 0.414477570279, 0.171044859442,
                         0.113559912572, 0.113559912572, 0.772880174856,
                         0.024895931491, 0.024895931491, 0.950208137018,
                         0.496135894741, 0.007728210518, 0.496135894741,
                         0.469608689653, 0.060782620693, 0.469608689653,
                         0.231110284949, 0.537779430102, 0.231110284949,
                         0.414477570279, 0.171044859442, 0.414477570279,
                         0.113559912572, 0.772880174856, 0.113559912572,
                         0.024895931491, 0.950208137018, 0.024895931491,
                         0.007728210518, 0.496135894741, 0.496135894741,
                         0.060782620693, 0.469608689653, 0.469608689653,
                         0.537779430102, 0.231110284949, 0.231110284949,
                         0.171044859442, 0.414477570279, 0.414477570279,
                         0.772880174856, 0.113559912572, 0.113559912572,
                         0.950208137018, 0.024895931491, 0.024895931491,
                         0.018988004384, 0.292078688577, 0.688933307040,
                         0.097736031066, 0.266745253310, 0.635518715624,
                         0.021966344207, 0.126799775784, 0.851233880010,
                         0.688933307040, 0.018988004384, 0.292078688577,
                         0.635518715624, 0.097736031066, 0.266745253310,
                         0.851233880010, 0.021966344207, 0.126799775784,
                         0.292078688577, 0.688933307040, 0.018988004384,
                         0.266745253310, 0.635518715624, 0.097736031066,
                         0.126799775784, 0.851233880010, 0.021966344207,
                         0.292078688577, 0.018988004384, 0.688933307040,
                         0.266745253310, 0.097736031066, 0.635518715624,
                         0.126799775784, 0.021966344207, 0.851233880010,
                         0.688933307040, 0.292078688577, 0.018988004384,
                         0.635518715624, 0.266745253310, 0.097736031066,
                         0.851233880010, 0.126799775784, 0.021966344207,
                         0.018988004384, 0.688933307040, 0.292078688577,
                         0.097736031066, 0.635518715624, 0.266745253310,
                         0.021966344207, 0.851233880010, 0.126799775784;
                points = points_.transpose();
                weights << 0.051622646664 / 2.0, 0.009941476361 / 2.0, 0.032781241604 / 2.0,
                         0.046062409593 / 2.0, 0.046947095542 / 2.0, 0.030903097976 / 2.0,
                         0.008029399795 / 2.0, 0.009941476361 / 2.0, 0.032781241604 / 2.0,
                         0.046062409593 / 2.0, 0.046947095542 / 2.0, 0.030903097976 / 2.0,
                         0.008029399795 / 2.0, 0.009941476361 / 2.0, 0.032781241604 / 2.0,
                         0.046062409593 / 2.0, 0.046947095542 / 2.0, 0.030903097976 / 2.0,
                         0.008029399795 / 2.0, 0.018125498646 / 2.0, 0.037211960457 / 2.0,
                         0.015393072684 / 2.0, 0.018125498646 / 2.0, 0.037211960457 / 2.0,
                         0.015393072684 / 2.0, 0.018125498646 / 2.0, 0.037211960457 / 2.0,
                         0.015393072684 / 2.0, 0.018125498646 / 2.0, 0.037211960457 / 2.0,
                         0.015393072684 / 2.0, 0.018125498646 / 2.0, 0.037211960457 / 2.0,
                         0.015393072684 / 2.0, 0.018125498646 / 2.0, 0.037211960457 / 2.0,
                         0.015393072684 / 2.0;
            }
            else if(deg == 14){
                num_points = 42;
                points.resize(3, 42);
                points_.resize(42, 3);
                weights.resize(42);
                points_ << 0.417644719340, 0.417644719340, 0.164710561319,
                         0.061799883091, 0.061799883091, 0.876400233818,
                         0.273477528309, 0.273477528309, 0.453044943382,
                         0.177205532413, 0.177205532413, 0.645588935175,
                         0.019390961249, 0.019390961249, 0.961218077503,
                         0.488963910362, 0.488963910362, 0.022072179276,
                         0.417644719340, 0.164710561319, 0.417644719340,
                         0.061799883091, 0.876400233818, 0.061799883091,
                         0.273477528309, 0.453044943382, 0.273477528309,
                         0.177205532413, 0.645588935175, 0.177205532413,
                         0.019390961249, 0.961218077503, 0.019390961249,
                         0.488963910362, 0.022072179276, 0.488963910362,
                         0.164710561319, 0.417644719340, 0.417644719340,
                         0.876400233818, 0.061799883091, 0.061799883091,
                         0.453044943382, 0.273477528309, 0.273477528309,
                         0.645588935175, 0.177205532413, 0.177205532413,
                         0.961218077503, 0.019390961249, 0.019390961249,
                         0.022072179276, 0.488963910362, 0.488963910362,
                         0.014646950056, 0.298372882136, 0.686980167808,
                         0.092916249357, 0.336861459796, 0.570222290847,
                         0.057124757404, 0.172266687821, 0.770608554775,
                         0.001268330933, 0.118974497697, 0.879757171370,
                         0.686980167808, 0.014646950056, 0.298372882136,
                         0.570222290847, 0.092916249357, 0.336861459796,
                         0.770608554775, 0.057124757404, 0.172266687821,
                         0.879757171370, 0.001268330933, 0.118974497697,
                         0.298372882136, 0.686980167808, 0.014646950056,
                         0.336861459796, 0.570222290847, 0.092916249357,
                         0.172266687821, 0.770608554775, 0.057124757404,
                         0.118974497697, 0.879757171370, 0.001268330933,
                         0.298372882136, 0.014646950056, 0.686980167808,
                         0.336861459796, 0.092916249357, 0.570222290847,
                         0.172266687821, 0.057124757404, 0.770608554775,
                         0.118974497697, 0.001268330933, 0.879757171370,
                         0.686980167808, 0.298372882136, 0.014646950056,
                         0.570222290847, 0.336861459796, 0.092916249357,
                         0.770608554775, 0.172266687821, 0.057124757404,
                         0.879757171370, 0.118974497697, 0.001268330933,
                         0.014646950056, 0.686980167808, 0.298372882136,
                         0.092916249357, 0.570222290847, 0.336861459796,
                         0.057124757404, 0.770608554775, 0.172266687821,
                         0.001268330933, 0.879757171370, 0.118974497697;
                points = points_.transpose();
                weights << 0.032788353544 / 2.0, 0.014433699670 / 2.0, 0.051774104507 / 2.0,
                         0.042162588737 / 2.0, 0.004923403602 / 2.0, 0.021883581369 / 2.0,
                         0.032788353544 / 2.0, 0.014433699670 / 2.0, 0.051774104507 / 2.0,
                         0.042162588737 / 2.0, 0.004923403602 / 2.0, 0.021883581369 / 2.0,
                         0.032788353544 / 2.0, 0.014433699670 / 2.0, 0.051774104507 / 2.0,
                         0.042162588737 / 2.0, 0.004923403602 / 2.0, 0.021883581369 / 2.0,
                         0.014436308114 / 2.0, 0.038571510787 / 2.0, 0.024665753213 / 2.0,
                         0.005010228839 / 2.0, 0.014436308114 / 2.0, 0.038571510787 / 2.0,
                         0.024665753213 / 2.0, 0.005010228839 / 2.0, 0.014436308114 / 2.0,
                         0.038571510787 / 2.0, 0.024665753213 / 2.0, 0.005010228839 / 2.0,
                         0.014436308114 / 2.0, 0.038571510787 / 2.0, 0.024665753213 / 2.0,
                         0.005010228839 / 2.0, 0.014436308114 / 2.0, 0.038571510787 / 2.0,
                         0.024665753213 / 2.0, 0.005010228839 / 2.0, 0.014436308114 / 2.0,
                         0.038571510787 / 2.0, 0.024665753213 / 2.0, 0.005010228839 / 2.0;
            }
        }
        else if(dimension == 3){
            if(deg == 1){
                num_points = 1;
                points.resize(4, 1);
                points_.resize(1, 4);
                weights.resize(1);
                points_ << 0.250000000000, 0.250000000000, 0.250000000000, 0.250000000000;
                points = points_.transpose();
                weights << 1.000000000000 / 6.0;
            }
            else if(deg == 2){
                num_points = 4;
                points.resize(4, 4);
                points_.resize(4, 4);
                weights.resize(4);
                points_ << 0.138196601125, 0.138196601125, 0.138196601125, 0.585410196625,
                         0.138196601125, 0.138196601125, 0.585410196625, 0.138196601125,
                         0.138196601125, 0.585410196625, 0.138196601125, 0.138196601125,
                         0.585410196625, 0.138196601125, 0.138196601125, 0.138196601125;
                points = points_.transpose();
                weights << 0.250000000000 / 6.0, 0.250000000000 / 6.0, 0.250000000000 / 6.0, 0.250000000000 / 6.0;
            }
            else if(deg == 3){
                num_points = 8;
                points.resize(4, 8);
                points_.resize(8, 4);
                weights.resize(8);
                points_ << 0.328163302516, 0.328163302516, 0.328163302516, 0.015510092451,
                         0.108047249898, 0.108047249898, 0.108047249898, 0.675858250305,
                         0.328163302516, 0.328163302516, 0.015510092451, 0.328163302516,
                         0.108047249898, 0.108047249898, 0.675858250305, 0.108047249898,
                         0.328163302516, 0.015510092451, 0.328163302516, 0.328163302516,
                         0.108047249898, 0.675858250305, 0.108047249898, 0.108047249898,
                         0.015510092451, 0.328163302516, 0.328163302516, 0.328163302516,
                         0.675858250305, 0.108047249898, 0.108047249898, 0.108047249898;
                points = points_.transpose();
                weights << 0.136217842537 / 6.0, 0.113782157463 / 6.0, 0.136217842537 / 6.0,
                         0.113782157463 / 6.0, 0.136217842537 / 6.0, 0.113782157463 / 6.0,
                         0.136217842537 / 6.0, 0.113782157463 / 6.0;
            }
            else if(deg == 4){
                num_points = 14;
                points.resize(4, 14);
                points_.resize(14, 4);
                weights.resize(14);
                points_ << 0.092735250311, 0.092735250311, 0.092735250311, 0.721794249067,
                         0.310885919263, 0.310885919263, 0.310885919263, 0.067342242210,
                         0.092735250311, 0.092735250311, 0.721794249067, 0.092735250311,
                         0.310885919263, 0.310885919263, 0.067342242210, 0.310885919263,
                         0.092735250311, 0.721794249067, 0.092735250311, 0.092735250311,
                         0.310885919263, 0.067342242210, 0.310885919263, 0.310885919263,
                         0.721794249067, 0.092735250311, 0.092735250311, 0.092735250311,
                         0.067342242210, 0.310885919263, 0.310885919263, 0.310885919263,
                         0.045503704126, 0.045503704126, 0.454496295874, 0.454496295874,
                         0.045503704126, 0.454496295874, 0.045503704126, 0.454496295874,
                         0.454496295874, 0.045503704126, 0.045503704126, 0.454496295874,
                         0.045503704126, 0.454496295874, 0.454496295874, 0.045503704126,
                         0.454496295874, 0.045503704126, 0.454496295874, 0.045503704126,
                         0.454496295874, 0.454496295874, 0.045503704126, 0.045503704126;
                points = points_.transpose();
                weights << 0.073493043116 / 6.0, 0.112687925718 / 6.0, 0.073493043116 / 6.0,
                         0.112687925718 / 6.0, 0.073493043116 / 6.0, 0.112687925718 / 6.0,
                         0.073493043116 / 6.0, 0.112687925718 / 6.0, 0.042546020777 / 6.0,
                         0.042546020777 / 6.0, 0.042546020777 / 6.0, 0.042546020777 / 6.0,
                         0.042546020777 / 6.0, 0.042546020777 / 6.0;
            }
            else if(deg == 5){
                num_points = 14;
                points.resize(4, 14);
                points_.resize(14, 4);
                weights.resize(14);
                points_ << 0.092735250311, 0.092735250311, 0.092735250311, 0.721794249067,
                         0.310885919263, 0.310885919263, 0.310885919263, 0.067342242210,
                         0.092735250311, 0.092735250311, 0.721794249067, 0.092735250311,
                         0.310885919263, 0.310885919263, 0.067342242210, 0.310885919263,
                         0.092735250311, 0.721794249067, 0.092735250311, 0.092735250311,
                         0.310885919263, 0.067342242210, 0.310885919263, 0.310885919263,
                         0.721794249067, 0.092735250311, 0.092735250311, 0.092735250311,
                         0.067342242210, 0.310885919263, 0.310885919263, 0.310885919263,
                         0.045503704126, 0.045503704126, 0.454496295874, 0.454496295874,
                         0.045503704126, 0.454496295874, 0.045503704126, 0.454496295874,
                         0.454496295874, 0.045503704126, 0.045503704126, 0.454496295874,
                         0.045503704126, 0.454496295874, 0.454496295874, 0.045503704126,
                         0.454496295874, 0.045503704126, 0.454496295874, 0.045503704126,
                         0.454496295874, 0.454496295874, 0.045503704126, 0.045503704126;
                points = points_.transpose();
                weights << 0.073493043116 / 6.0, 0.112687925718 / 6.0, 0.073493043116 / 6.0,
                         0.112687925718 / 6.0, 0.073493043116 / 6.0, 0.112687925718 / 6.0,
                         0.073493043116 / 6.0, 0.112687925718 / 6.0, 0.042546020777 / 6.0,
                         0.042546020777 / 6.0, 0.042546020777 / 6.0, 0.042546020777 / 6.0,
                         0.042546020777 / 6.0, 0.042546020777 / 6.0;
            }
            else if(deg == 6){
                num_points = 24;
                points.resize(4, 24);
                points_.resize(24, 4);
                weights.resize(24);
                points_ << 0.214602871259, 0.214602871259, 0.214602871259, 0.356191386223,
                         0.040673958535, 0.040673958535, 0.040673958535, 0.877978124396,
                         0.322337890142, 0.322337890142, 0.322337890142, 0.032986329573,
                         0.214602871259, 0.214602871259, 0.356191386223, 0.214602871259,
                         0.040673958535, 0.040673958535, 0.877978124396, 0.040673958535,
                         0.322337890142, 0.322337890142, 0.032986329573, 0.322337890142,
                         0.214602871259, 0.356191386223, 0.214602871259, 0.214602871259,
                         0.040673958535, 0.877978124396, 0.040673958535, 0.040673958535,
                         0.322337890142, 0.032986329573, 0.322337890142, 0.322337890142,
                         0.356191386223, 0.214602871259, 0.214602871259, 0.214602871259,
                         0.877978124396, 0.040673958535, 0.040673958535, 0.040673958535,
                         0.032986329573, 0.322337890142, 0.322337890142, 0.322337890142,
                         0.063661001875, 0.063661001875, 0.269672331458, 0.603005664792,
                         0.063661001875, 0.269672331458, 0.063661001875, 0.603005664792,
                         0.269672331458, 0.063661001875, 0.063661001875, 0.603005664792,
                         0.063661001875, 0.269672331458, 0.603005664792, 0.063661001875,
                         0.269672331458, 0.063661001875, 0.603005664792, 0.063661001875,
                         0.269672331458, 0.603005664792, 0.063661001875, 0.063661001875,
                         0.063661001875, 0.063661001875, 0.603005664792, 0.269672331458,
                         0.063661001875, 0.603005664792, 0.063661001875, 0.269672331458,
                         0.603005664792, 0.063661001875, 0.063661001875, 0.269672331458,
                         0.063661001875, 0.603005664792, 0.269672331458, 0.063661001875,
                         0.603005664792, 0.063661001875, 0.269672331458, 0.063661001875,
                         0.603005664792, 0.269672331458, 0.063661001875, 0.063661001875;
                points = points_.transpose();
                weights << 0.039922750258 / 6.0, 0.010077211055 / 6.0, 0.055357181544 / 6.0,
                         0.039922750258 / 6.0, 0.010077211055 / 6.0, 0.055357181544 / 6.0,
                         0.039922750258 / 6.0, 0.010077211055 / 6.0, 0.055357181544 / 6.0,
                         0.039922750258 / 6.0, 0.010077211055 / 6.0, 0.055357181544 / 6.0,
                         0.048214285714 / 6.0, 0.048214285714 / 6.0, 0.048214285714 / 6.0,
                         0.048214285714 / 6.0, 0.048214285714 / 6.0, 0.048214285714 / 6.0,
                         0.048214285714 / 6.0, 0.048214285714 / 6.0, 0.048214285714 / 6.0,
                         0.048214285714 / 6.0, 0.048214285714 / 6.0, 0.048214285714 / 6.0;
            }
            else if(deg == 7){
                num_points = 35;
                points.resize(4, 35);
                points_.resize(35, 4);
                weights.resize(35);
                points_ << 0.250000000000, 0.250000000000, 0.250000000000, 0.250000000000,
                         0.315701149778, 0.315701149778, 0.315701149778, 0.052896550665,
                         0.315701149778, 0.315701149778, 0.052896550665, 0.315701149778,
                         0.315701149778, 0.052896550665, 0.315701149778, 0.315701149778,
                         0.052896550665, 0.315701149778, 0.315701149778, 0.315701149778,
                         0.050489822598, 0.050489822598, 0.449510177402, 0.449510177402,
                         0.050489822598, 0.449510177402, 0.050489822598, 0.449510177402,
                         0.449510177402, 0.050489822598, 0.050489822598, 0.449510177402,
                         0.050489822598, 0.449510177402, 0.449510177402, 0.050489822598,
                         0.449510177402, 0.050489822598, 0.449510177402, 0.050489822598,
                         0.449510177402, 0.449510177402, 0.050489822598, 0.050489822598,
                         0.188833831026, 0.188833831026, 0.575171637587, 0.047160700361,
                         0.021265472541, 0.021265472541, 0.810830241099, 0.146638813818,
                         0.188833831026, 0.575171637587, 0.188833831026, 0.047160700361,
                         0.021265472541, 0.810830241099, 0.021265472541, 0.146638813818,
                         0.575171637587, 0.188833831026, 0.188833831026, 0.047160700361,
                         0.810830241099, 0.021265472541, 0.021265472541, 0.146638813818,
                         0.188833831026, 0.575171637587, 0.047160700361, 0.188833831026,
                         0.021265472541, 0.810830241099, 0.146638813818, 0.021265472541,
                         0.575171637587, 0.188833831026, 0.047160700361, 0.188833831026,
                         0.810830241099, 0.021265472541, 0.146638813818, 0.021265472541,
                         0.575171637587, 0.047160700361, 0.188833831026, 0.188833831026,
                         0.810830241099, 0.146638813818, 0.021265472541, 0.021265472541,
                         0.188833831026, 0.188833831026, 0.047160700361, 0.575171637587,
                         0.021265472541, 0.021265472541, 0.146638813818, 0.810830241099,
                         0.188833831026, 0.047160700361, 0.188833831026, 0.575171637587,
                         0.021265472541, 0.146638813818, 0.021265472541, 0.810830241099,
                         0.047160700361, 0.188833831026, 0.188833831026, 0.575171637587,
                         0.146638813818, 0.021265472541, 0.021265472541, 0.810830241099,
                         0.188833831026, 0.047160700361, 0.575171637587, 0.188833831026,
                         0.021265472541, 0.146638813818, 0.810830241099, 0.021265472541,
                         0.047160700361, 0.188833831026, 0.575171637587, 0.188833831026,
                         0.146638813818, 0.021265472541, 0.810830241099, 0.021265472541,
                         0.047160700361, 0.575171637587, 0.188833831026, 0.188833831026,
                         0.146638813818, 0.810830241099, 0.021265472541, 0.021265472541;
                points = points_.transpose();
                weights << 0.095485289464 / 6.0, 0.042329581210 / 6.0, 0.042329581210 / 6.0,
                         0.042329581210 / 6.0, 0.042329581210 / 6.0, 0.031896927833 / 6.0,
                         0.031896927833 / 6.0, 0.031896927833 / 6.0, 0.031896927833 / 6.0,
                         0.031896927833 / 6.0, 0.031896927833 / 6.0, 0.037207130728 / 6.0,
                         0.008110770830 / 6.0, 0.037207130728 / 6.0, 0.008110770830 / 6.0,
                         0.037207130728 / 6.0, 0.008110770830 / 6.0, 0.037207130728 / 6.0,
                         0.008110770830 / 6.0, 0.037207130728 / 6.0, 0.008110770830 / 6.0,
                         0.037207130728 / 6.0, 0.008110770830 / 6.0, 0.037207130728 / 6.0,
                         0.008110770830 / 6.0, 0.037207130728 / 6.0, 0.008110770830 / 6.0,
                         0.037207130728 / 6.0, 0.008110770830 / 6.0, 0.037207130728 / 6.0,
                         0.008110770830 / 6.0, 0.037207130728 / 6.0, 0.008110770830 / 6.0,
                         0.037207130728 / 6.0, 0.008110770830 / 6.0;
            }
            else if(deg == 8){
                num_points = 46;
                points.resize(4, 46);
                points_.resize(46, 4);
                weights.resize(46);
                points_ << 0.107952724962, 0.107952724962, 0.107952724962, 0.676141825113,
                         0.185109487783, 0.185109487783, 0.185109487783, 0.444671536652,
                         0.042316543685, 0.042316543685, 0.042316543685, 0.873050368946,
                         0.314181709124, 0.314181709124, 0.314181709124, 0.057454872628,
                         0.107952724962, 0.107952724962, 0.676141825113, 0.107952724962,
                         0.185109487783, 0.185109487783, 0.444671536652, 0.185109487783,
                         0.042316543685, 0.042316543685, 0.873050368946, 0.042316543685,
                         0.314181709124, 0.314181709124, 0.057454872628, 0.314181709124,
                         0.107952724962, 0.676141825113, 0.107952724962, 0.107952724962,
                         0.185109487783, 0.444671536652, 0.185109487783, 0.185109487783,
                         0.042316543685, 0.873050368946, 0.042316543685, 0.042316543685,
                         0.314181709124, 0.057454872628, 0.314181709124, 0.314181709124,
                         0.676141825113, 0.107952724962, 0.107952724962, 0.107952724962,
                         0.444671536652, 0.185109487783, 0.185109487783, 0.185109487783,
                         0.873050368946, 0.042316543685, 0.042316543685, 0.042316543685,
                         0.057454872628, 0.314181709124, 0.314181709124, 0.314181709124,
                         0.435591328584, 0.435591328584, 0.064408671416, 0.064408671416,
                         0.435591328584, 0.064408671416, 0.435591328584, 0.064408671416,
                         0.064408671416, 0.435591328584, 0.435591328584, 0.064408671416,
                         0.435591328584, 0.064408671416, 0.064408671416, 0.435591328584,
                         0.064408671416, 0.435591328584, 0.064408671416, 0.435591328584,
                         0.064408671416, 0.064408671416, 0.435591328584, 0.435591328584,
                         0.021433930127, 0.021433930127, 0.717464063426, 0.239668076319,
                         0.204139333876, 0.204139333876, 0.583797378302, 0.007923953946,
                         0.021433930127, 0.717464063426, 0.021433930127, 0.239668076319,
                         0.204139333876, 0.583797378302, 0.204139333876, 0.007923953946,
                         0.717464063426, 0.021433930127, 0.021433930127, 0.239668076319,
                         0.583797378302, 0.204139333876, 0.204139333876, 0.007923953946,
                         0.021433930127, 0.717464063426, 0.239668076319, 0.021433930127,
                         0.204139333876, 0.583797378302, 0.007923953946, 0.204139333876,
                         0.717464063426, 0.021433930127, 0.239668076319, 0.021433930127,
                         0.583797378302, 0.204139333876, 0.007923953946, 0.204139333876,
                         0.717464063426, 0.239668076319, 0.021433930127, 0.021433930127,
                         0.583797378302, 0.007923953946, 0.204139333876, 0.204139333876,
                         0.021433930127, 0.021433930127, 0.239668076319, 0.717464063426,
                         0.204139333876, 0.204139333876, 0.007923953946, 0.583797378302,
                         0.021433930127, 0.239668076319, 0.021433930127, 0.717464063426,
                         0.204139333876, 0.007923953946, 0.204139333876, 0.583797378302,
                         0.239668076319, 0.021433930127, 0.021433930127, 0.717464063426,
                         0.007923953946, 0.204139333876, 0.204139333876, 0.583797378302,
                         0.021433930127, 0.239668076319, 0.717464063426, 0.021433930127,
                         0.204139333876, 0.007923953946, 0.583797378302, 0.204139333876,
                         0.239668076319, 0.021433930127, 0.717464063426, 0.021433930127,
                         0.007923953946, 0.204139333876, 0.583797378302, 0.204139333876,
                         0.239668076319, 0.717464063426, 0.021433930127, 0.021433930127,
                         0.007923953946, 0.583797378302, 0.204139333876, 0.204139333876;
                points = points_.transpose();
                weights << 0.026426650908 / 6.0, 0.052031747564 / 6.0, 0.007525256154 / 6.0,
                         0.041763782857 / 6.0, 0.026426650908 / 6.0, 0.052031747564 / 6.0,
                         0.007525256154 / 6.0, 0.041763782857 / 6.0, 0.026426650908 / 6.0,
                         0.052031747564 / 6.0, 0.007525256154 / 6.0, 0.041763782857 / 6.0,
                         0.026426650908 / 6.0, 0.052031747564 / 6.0, 0.007525256154 / 6.0,
                         0.041763782857 / 6.0, 0.036280930261 / 6.0, 0.036280930261 / 6.0,
                         0.036280930261 / 6.0, 0.036280930261 / 6.0, 0.036280930261 / 6.0,
                         0.036280930261 / 6.0, 0.007156902891 / 6.0, 0.015453486151 / 6.0,
                         0.007156902891 / 6.0, 0.015453486151 / 6.0, 0.007156902891 / 6.0,
                         0.015453486151 / 6.0, 0.007156902891 / 6.0, 0.015453486151 / 6.0,
                         0.007156902891 / 6.0, 0.015453486151 / 6.0, 0.007156902891 / 6.0,
                         0.015453486151 / 6.0, 0.007156902891 / 6.0, 0.015453486151 / 6.0,
                         0.007156902891 / 6.0, 0.015453486151 / 6.0, 0.007156902891 / 6.0,
                         0.015453486151 / 6.0, 0.007156902891 / 6.0, 0.015453486151 / 6.0,
                         0.007156902891 / 6.0, 0.015453486151 / 6.0, 0.007156902891 / 6.0,
                         0.015453486151 / 6.0, 0.007156902891 / 6.0, 0.015453486151 / 6.0;
            }
            else if(deg == 9){
                num_points = 59;
                points.resize(4, 59);
                points_.resize(59, 4);
                weights.resize(59);
                points_ << 0.250000000000, 0.250000000000, 0.250000000000, 0.250000000000,
                         0.000000000620, 0.000000000620, 0.000000000620, 0.999999998141,
                         0.160774535395, 0.160774535395, 0.160774535395, 0.517676393814,
                         0.322276521821, 0.322276521821, 0.322276521821, 0.033170434536,
                         0.045108918345, 0.045108918345, 0.045108918345, 0.864673244964,
                         0.000000000620, 0.000000000620, 0.999999998141, 0.000000000620,
                         0.160774535395, 0.160774535395, 0.517676393814, 0.160774535395,
                         0.322276521821, 0.322276521821, 0.033170434536, 0.322276521821,
                         0.045108918345, 0.045108918345, 0.864673244964, 0.045108918345,
                         0.000000000620, 0.999999998141, 0.000000000620, 0.000000000620,
                         0.160774535395, 0.517676393814, 0.160774535395, 0.160774535395,
                         0.322276521821, 0.033170434536, 0.322276521821, 0.322276521821,
                         0.045108918345, 0.864673244964, 0.045108918345, 0.045108918345,
                         0.999999998141, 0.000000000620, 0.000000000620, 0.000000000620,
                         0.517676393814, 0.160774535395, 0.160774535395, 0.160774535395,
                         0.033170434536, 0.322276521821, 0.322276521821, 0.322276521821,
                         0.864673244964, 0.045108918345, 0.045108918345, 0.045108918345,
                         0.112296546004, 0.112296546004, 0.387703453996, 0.387703453996,
                         0.112296546004, 0.387703453996, 0.112296546004, 0.387703453996,
                         0.387703453996, 0.112296546004, 0.112296546004, 0.387703453996,
                         0.112296546004, 0.387703453996, 0.387703453996, 0.112296546004,
                         0.387703453996, 0.112296546004, 0.387703453996, 0.112296546004,
                         0.387703453996, 0.387703453996, 0.112296546004, 0.112296546004,
                         0.458871448752, 0.458871448752, 0.002554579233, 0.079702523262,
                         0.033775870685, 0.033775870685, 0.718350326442, 0.214097932187,
                         0.183641369810, 0.183641369810, 0.034415910578, 0.598301349802,
                         0.458871448752, 0.002554579233, 0.458871448752, 0.079702523262,
                         0.033775870685, 0.718350326442, 0.033775870685, 0.214097932187,
                         0.183641369810, 0.034415910578, 0.183641369810, 0.598301349802,
                         0.002554579233, 0.458871448752, 0.458871448752, 0.079702523262,
                         0.718350326442, 0.033775870685, 0.033775870685, 0.214097932187,
                         0.034415910578, 0.183641369810, 0.183641369810, 0.598301349802,
                         0.458871448752, 0.002554579233, 0.079702523262, 0.458871448752,
                         0.033775870685, 0.718350326442, 0.214097932187, 0.033775870685,
                         0.183641369810, 0.034415910578, 0.598301349802, 0.183641369810,
                         0.002554579233, 0.458871448752, 0.079702523262, 0.458871448752,
                         0.718350326442, 0.033775870685, 0.214097932187, 0.033775870685,
                         0.034415910578, 0.183641369810, 0.598301349802, 0.183641369810,
                         0.002554579233, 0.079702523262, 0.458871448752, 0.458871448752,
                         0.718350326442, 0.214097932187, 0.033775870685, 0.033775870685,
                         0.034415910578, 0.598301349802, 0.183641369810, 0.183641369810,
                         0.458871448752, 0.458871448752, 0.079702523262, 0.002554579233,
                         0.033775870685, 0.033775870685, 0.214097932187, 0.718350326442,
                         0.183641369810, 0.183641369810, 0.598301349802, 0.034415910578,
                         0.458871448752, 0.079702523262, 0.458871448752, 0.002554579233,
                         0.033775870685, 0.214097932187, 0.033775870685, 0.718350326442,
                         0.183641369810, 0.598301349802, 0.183641369810, 0.034415910578,
                         0.079702523262, 0.458871448752, 0.458871448752, 0.002554579233,
                         0.214097932187, 0.033775870685, 0.033775870685, 0.718350326442,
                         0.598301349802, 0.183641369810, 0.183641369810, 0.034415910578,
                         0.458871448752, 0.079702523262, 0.002554579233, 0.458871448752,
                         0.033775870685, 0.214097932187, 0.718350326442, 0.033775870685,
                         0.183641369810, 0.598301349802, 0.034415910578, 0.183641369810,
                         0.079702523262, 0.458871448752, 0.002554579233, 0.458871448752,
                         0.214097932187, 0.033775870685, 0.718350326442, 0.033775870685,
                         0.598301349802, 0.183641369810, 0.034415910578, 0.183641369810,
                         0.079702523262, 0.002554579233, 0.458871448752, 0.458871448752,
                         0.214097932187, 0.718350326442, 0.033775870685, 0.033775870685,
                         0.598301349802, 0.034415910578, 0.183641369810, 0.183641369810;
                points = points_.transpose();
                weights << 0.058010548912 / 6.0, 0.000064319282 / 6.0, 0.023173338462 / 6.0,
                         0.029562912335 / 6.0, 0.008063979980 / 6.0, 0.000064319282 / 6.0,
                         0.023173338462 / 6.0, 0.029562912335 / 6.0, 0.008063979980 / 6.0,
                         0.000064319282 / 6.0, 0.023173338462 / 6.0, 0.029562912335 / 6.0,
                         0.008063979980 / 6.0, 0.000064319282 / 6.0, 0.023173338462 / 6.0,
                         0.029562912335 / 6.0, 0.008063979980 / 6.0, 0.038134080104 / 6.0,
                         0.038134080104 / 6.0, 0.038134080104 / 6.0, 0.038134080104 / 6.0,
                         0.038134080104 / 6.0, 0.038134080104 / 6.0, 0.008384422198 / 6.0,
                         0.010234559353 / 6.0, 0.020524915968 / 6.0, 0.008384422198 / 6.0,
                         0.010234559353 / 6.0, 0.020524915968 / 6.0, 0.008384422198 / 6.0,
                         0.010234559353 / 6.0, 0.020524915968 / 6.0, 0.008384422198 / 6.0,
                         0.010234559353 / 6.0, 0.020524915968 / 6.0, 0.008384422198 / 6.0,
                         0.010234559353 / 6.0, 0.020524915968 / 6.0, 0.008384422198 / 6.0,
                         0.010234559353 / 6.0, 0.020524915968 / 6.0, 0.008384422198 / 6.0,
                         0.010234559353 / 6.0, 0.020524915968 / 6.0, 0.008384422198 / 6.0,
                         0.010234559353 / 6.0, 0.020524915968 / 6.0, 0.008384422198 / 6.0,
                         0.010234559353 / 6.0, 0.020524915968 / 6.0, 0.008384422198 / 6.0,
                         0.010234559353 / 6.0, 0.020524915968 / 6.0, 0.008384422198 / 6.0,
                         0.010234559353 / 6.0, 0.020524915968 / 6.0, 0.008384422198 / 6.0,
                         0.010234559353 / 6.0, 0.020524915968 / 6.0, 0.008384422198 / 6.0,
                         0.010234559353 / 6.0, 0.020524915968 / 6.0, 0.008384422198 / 6.0,
                         0.010234559353 / 6.0, 0.020524915968 / 6.0;
            }
            else if(deg == 10){
                num_points = 81;
                points.resize(4, 81);
                points_.resize(81, 4);
                weights.resize(81);
                points_ << 0.250000000000, 0.250000000000, 0.250000000000, 0.250000000000,
                         0.312250068695, 0.312250068695, 0.312250068695, 0.063249793914,
                         0.114309653857, 0.114309653857, 0.114309653857, 0.657071038428,
                         0.312250068695, 0.312250068695, 0.063249793914, 0.312250068695,
                         0.114309653857, 0.114309653857, 0.657071038428, 0.114309653857,
                         0.312250068695, 0.063249793914, 0.312250068695, 0.312250068695,
                         0.114309653857, 0.657071038428, 0.114309653857, 0.114309653857,
                         0.063249793914, 0.312250068695, 0.312250068695, 0.312250068695,
                         0.657071038428, 0.114309653857, 0.114309653857, 0.114309653857,
                         0.410430739219, 0.410430739219, 0.165486025620, 0.013652495942,
                         0.006138008825, 0.006138008825, 0.942988767345, 0.044735215005,
                         0.121050181146, 0.121050181146, 0.477190379904, 0.280709257805,
                         0.032779468216, 0.032779468216, 0.594256269480, 0.340184794087,
                         0.032485281565, 0.032485281565, 0.801177284658, 0.133852152212,
                         0.174979342184, 0.174979342184, 0.628071845475, 0.021969470157,
                         0.410430739219, 0.165486025620, 0.410430739219, 0.013652495942,
                         0.006138008825, 0.942988767345, 0.006138008825, 0.044735215005,
                         0.121050181146, 0.477190379904, 0.121050181146, 0.280709257805,
                         0.032779468216, 0.594256269480, 0.032779468216, 0.340184794087,
                         0.032485281565, 0.801177284658, 0.032485281565, 0.133852152212,
                         0.174979342184, 0.628071845475, 0.174979342184, 0.021969470157,
                         0.165486025620, 0.410430739219, 0.410430739219, 0.013652495942,
                         0.942988767345, 0.006138008825, 0.006138008825, 0.044735215005,
                         0.477190379904, 0.121050181146, 0.121050181146, 0.280709257805,
                         0.594256269480, 0.032779468216, 0.032779468216, 0.340184794087,
                         0.801177284658, 0.032485281565, 0.032485281565, 0.133852152212,
                         0.628071845475, 0.174979342184, 0.174979342184, 0.021969470157,
                         0.410430739219, 0.165486025620, 0.013652495942, 0.410430739219,
                         0.006138008825, 0.942988767345, 0.044735215005, 0.006138008825,
                         0.121050181146, 0.477190379904, 0.280709257805, 0.121050181146,
                         0.032779468216, 0.594256269480, 0.340184794087, 0.032779468216,
                         0.032485281565, 0.801177284658, 0.133852152212, 0.032485281565,
                         0.174979342184, 0.628071845475, 0.021969470157, 0.174979342184,
                         0.165486025620, 0.410430739219, 0.013652495942, 0.410430739219,
                         0.942988767345, 0.006138008825, 0.044735215005, 0.006138008825,
                         0.477190379904, 0.121050181146, 0.280709257805, 0.121050181146,
                         0.594256269480, 0.032779468216, 0.340184794087, 0.032779468216,
                         0.801177284658, 0.032485281565, 0.133852152212, 0.032485281565,
                         0.628071845475, 0.174979342184, 0.021969470157, 0.174979342184,
                         0.165486025620, 0.013652495942, 0.410430739219, 0.410430739219,
                         0.942988767345, 0.044735215005, 0.006138008825, 0.006138008825,
                         0.477190379904, 0.280709257805, 0.121050181146, 0.121050181146,
                         0.594256269480, 0.340184794087, 0.032779468216, 0.032779468216,
                         0.801177284658, 0.133852152212, 0.032485281565, 0.032485281565,
                         0.628071845475, 0.021969470157, 0.174979342184, 0.174979342184,
                         0.410430739219, 0.410430739219, 0.013652495942, 0.165486025620,
                         0.006138008825, 0.006138008825, 0.044735215005, 0.942988767345,
                         0.121050181146, 0.121050181146, 0.280709257805, 0.477190379904,
                         0.032779468216, 0.032779468216, 0.340184794087, 0.594256269480,
                         0.032485281565, 0.032485281565, 0.133852152212, 0.801177284658,
                         0.174979342184, 0.174979342184, 0.021969470157, 0.628071845475,
                         0.410430739219, 0.013652495942, 0.410430739219, 0.165486025620,
                         0.006138008825, 0.044735215005, 0.006138008825, 0.942988767345,
                         0.121050181146, 0.280709257805, 0.121050181146, 0.477190379904,
                         0.032779468216, 0.340184794087, 0.032779468216, 0.594256269480,
                         0.032485281565, 0.133852152212, 0.032485281565, 0.801177284658,
                         0.174979342184, 0.021969470157, 0.174979342184, 0.628071845475,
                         0.013652495942, 0.410430739219, 0.410430739219, 0.165486025620,
                         0.044735215005, 0.006138008825, 0.006138008825, 0.942988767345,
                         0.280709257805, 0.121050181146, 0.121050181146, 0.477190379904,
                         0.340184794087, 0.032779468216, 0.032779468216, 0.594256269480,
                         0.133852152212, 0.032485281565, 0.032485281565, 0.801177284658,
                         0.021969470157, 0.174979342184, 0.174979342184, 0.628071845475,
                         0.410430739219, 0.013652495942, 0.165486025620, 0.410430739219,
                         0.006138008825, 0.044735215005, 0.942988767345, 0.006138008825,
                         0.121050181146, 0.280709257805, 0.477190379904, 0.121050181146,
                         0.032779468216, 0.340184794087, 0.594256269480, 0.032779468216,
                         0.032485281565, 0.133852152212, 0.801177284658, 0.032485281565,
                         0.174979342184, 0.021969470157, 0.628071845475, 0.174979342184,
                         0.013652495942, 0.410430739219, 0.165486025620, 0.410430739219,
                         0.044735215005, 0.006138008825, 0.942988767345, 0.006138008825,
                         0.280709257805, 0.121050181146, 0.477190379904, 0.121050181146,
                         0.340184794087, 0.032779468216, 0.594256269480, 0.032779468216,
                         0.133852152212, 0.032485281565, 0.801177284658, 0.032485281565,
                         0.021969470157, 0.174979342184, 0.628071845475, 0.174979342184,
                         0.013652495942, 0.165486025620, 0.410430739219, 0.410430739219,
                         0.044735215005, 0.942988767345, 0.006138008825, 0.006138008825,
                         0.280709257805, 0.477190379904, 0.121050181146, 0.121050181146,
                         0.340184794087, 0.594256269480, 0.032779468216, 0.032779468216,
                         0.133852152212, 0.801177284658, 0.032485281565, 0.032485281565,
                         0.021969470157, 0.628071845475, 0.174979342184, 0.174979342184;
                points = points_.transpose();
                weights << 0.047399773556 / 6.0, 0.026937059992 / 6.0, 0.009869159717 / 6.0,
                         0.026937059992 / 6.0, 0.009869159717 / 6.0, 0.026937059992 / 6.0,
                         0.009869159717 / 6.0, 0.026937059992 / 6.0, 0.009869159717 / 6.0,
                         0.011393881220 / 6.0, 0.000361944344 / 6.0, 0.025739731980 / 6.0,
                         0.010135871680 / 6.0, 0.006576147277 / 6.0, 0.012907035799 / 6.0,
                         0.011393881220 / 6.0, 0.000361944344 / 6.0, 0.025739731980 / 6.0,
                         0.010135871680 / 6.0, 0.006576147277 / 6.0, 0.012907035799 / 6.0,
                         0.011393881220 / 6.0, 0.000361944344 / 6.0, 0.025739731980 / 6.0,
                         0.010135871680 / 6.0, 0.006576147277 / 6.0, 0.012907035799 / 6.0,
                         0.011393881220 / 6.0, 0.000361944344 / 6.0, 0.025739731980 / 6.0,
                         0.010135871680 / 6.0, 0.006576147277 / 6.0, 0.012907035799 / 6.0,
                         0.011393881220 / 6.0, 0.000361944344 / 6.0, 0.025739731980 / 6.0,
                         0.010135871680 / 6.0, 0.006576147277 / 6.0, 0.012907035799 / 6.0,
                         0.011393881220 / 6.0, 0.000361944344 / 6.0, 0.025739731980 / 6.0,
                         0.010135871680 / 6.0, 0.006576147277 / 6.0, 0.012907035799 / 6.0,
                         0.011393881220 / 6.0, 0.000361944344 / 6.0, 0.025739731980 / 6.0,
                         0.010135871680 / 6.0, 0.006576147277 / 6.0, 0.012907035799 / 6.0,
                         0.011393881220 / 6.0, 0.000361944344 / 6.0, 0.025739731980 / 6.0,
                         0.010135871680 / 6.0, 0.006576147277 / 6.0, 0.012907035799 / 6.0,
                         0.011393881220 / 6.0, 0.000361944344 / 6.0, 0.025739731980 / 6.0,
                         0.010135871680 / 6.0, 0.006576147277 / 6.0, 0.012907035799 / 6.0,
                         0.011393881220 / 6.0, 0.000361944344 / 6.0, 0.025739731980 / 6.0,
                         0.010135871680 / 6.0, 0.006576147277 / 6.0, 0.012907035799 / 6.0,
                         0.011393881220 / 6.0, 0.000361944344 / 6.0, 0.025739731980 / 6.0,
                         0.010135871680 / 6.0, 0.006576147277 / 6.0, 0.012907035799 / 6.0,
                         0.011393881220 / 6.0, 0.000361944344 / 6.0, 0.025739731980 / 6.0,
                         0.010135871680 / 6.0, 0.006576147277 / 6.0, 0.012907035799 / 6.0;
            }
            else if(deg >= 11 && deg <= 14){
                int N;
                if(deg == 11){
                    N = 165;
                }
                else if(deg == 12){
                    N = 220;
                }
                else if(deg == 13){
                    N = 220;
                }
                else if(deg == 14){
                    N = 236;
                }

                num_points = N;
                points.resize(4, N);
                weights.resize(N);
                std::ifstream file("./include/PolyFem/quadpoints/quad3D_" + std::to_string(N) + ".txt");
                if (!file.is_open()) {
                    throw std::runtime_error("Could not open quadrature file: quad3D_" + std::to_string(N) + ".txt");
                }
                for (int i = 0; i < N; i++) {
                    double l1, l2, l3, l4, w;
                    if (!(file >> l1 >> l2 >> l3 >> l4 >> w)) {
                        std::cerr << "Error reading quadrature data at line " << (i + 1) << std::endl;
                        break;
                    }
                    points(0, i) = l1;
                    points(1, i) = l2;
                    points(2, i) = l3;
                    points(3, i) = l4;
                    weights(i) = w / 6.0;
                }
            }
        }
    }

    template<int dim, int degree>
    Quadrature<dim, degree>::~Quadrature(){
        // Destructor - Eigen matrices will be automatically cleaned up
    }

}